services:
    # ---------- Backend API (Node + Express) ----------
    - type: web
      name: draft-helper-api
      env: node
      plan: free
      rootDir: backend # change if needed
      buildCommand: npm install
      startCommand: node server.js
      autoDeploy: true

      envVars:
          - key: NODE_ENV
            value: production
          - key: PORT
            value: 4000

          # ==== Secure environment variables set in Render dashboard ====
          - key: MONGODB_URI
            sync: false

          - key: AUTH0_DOMAIN
            sync: false
          - key: AUTH0_AUDIENCE
            sync: false

          # You can also wire this from the frontend service's host if you want,
          # but hardcoding is fine too once you know the URL
          - key: CORS_ORIGIN
            value: https://draft-helper-frontend.onrender.com

    # ---------- Frontend (Vite React static site) ----------
    - type: web
      name: draft-helper-frontend
      env: static
      plan: free
      rootDir: frontend # update if your Vite project is elsewhere
      buildCommand: npm install && npm run build
      staticPublishPath: dist

      envVars:
          # Get the backend host from Render. Valid properties: host, hostport, port, connectionString
          - key: VITE_API_HOST
            fromService:
                type: web
                name: draft-helper-api
                property:
